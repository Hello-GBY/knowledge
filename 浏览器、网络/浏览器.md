# 浏览器
参考网站：https://tsejx.github.io/javascript-guidebook/

## （一）进程线程概念
1. 进程是资源分配的最小单位，线程是cpu调度的最小单位。
2. 一个进程可以包含多个线程。
3. 进程在执行过程中拥有独立的内存单元。
4. 多个线程共享进程的内存
5. 进程之间的内容相互隔离

```js
   扩展：浏览器的五种进程 
    1. 浏览器进程  - 1个
    2. 网络进程    - 1个
    3. GPU进程     - 1个
    4. 渲染进程    - 多个
    5. 插件进程    - 多个

    浏览器进程
        - 主要负责 界面显示，用户交互，子进程管理，同时提供存储功能
    网络进程
        主要负责页面 ( 加载网络资源 )
    渲染进程 - 多个
        - 核心任务是将HTML、CSS 和 JavaScript 转换为用户可以与之交互的页面
        - 默认情况下，Chrome会为 ( 每个Tab标签都创建一个渲染进程 )。出于安全考虑，渲染进程都是运行在沙箱模式下
    GPU进程
        - 3D效果 GPU绘制
        - 除了 Chrome 静默地利用 GPU 进行渲染加速
    插件进程 - 多个
        - 主要是负责插件的运行，因插件易崩溃，所以需要通过插件进程来隔离，**以保证插件进程崩溃不会对浏览器和页面造成影响**
```

```js
    扩展：浏览器渲染进程的线程有哪些

    **浏览器的渲染进程的线程总共有五种：**
    1. GUI渲染线程
    2. JS引擎线程
    3. 定时任务线程
    4. 事件触发线程
    5. 异步http请求线程

```

## （二）浏览器-安全
 - csrf攻击
 - XSS攻击
 - DDoS 攻击
 - 流量劫持

```js
1. csrf
- 名词解释
    - cross site request forgery 跨站请求伪造
- 原理
    - 是通过获取目标网站的 cookie
    - 在a.com 中登录之后 点击了 b.com这个钓鱼网站 在这个钓鱼网站中有对a.com的接口就会默认携带cookie, 这样就能伪造用户的行为进行攻击。
    - 即获取了cookie，就可以做很多事情：比如以你的名义发送邮件、发信息、盗取账号、购买商品、虚拟货币转账等等
- 如何预防 csrf 攻击呢?
    - 验证码
    - 判断refer
    - cookie 设置 SameSite
    - 增加token
```

```js 
2. XSS
- 名词解释
    - cors site script 跨站脚本攻击 因为冲突 css 所以叫XSS
- 原理
    - 主要是通过输入脚本再解析;
    - 获取页面的数据，如DOM、Cookie、localStorage;
    - DDOS攻击，发送合理请求，占用服务器资源，从而使用户无法访问服务器;
    - 破坏页面结构;
    - 流量劫持（将链接指向某网站）;
- 攻击方式
  - 持久型 - 又叫存储型
  - 非持久型 - 又叫反射型
  - 基于 DOM

  1. 持久型
       如论坛发帖、商品评论、⽤户私信等。
  2. 非持久型
       非持续型 XSS 的恶意代码存在 URL ⾥。 
  3. 基于DOM
       ⽤户浏览器接收到响应后解析执⾏，前端 JavaScript 取出 URL 中的恶意代码并执⾏。 
       DOM 型 XSS 攻击中，取出和执⾏恶意代码由浏览器端完成，属于前端JavaScript ⾃身的安全漏洞，⽽其他两种 XSS 都属于服务端的安全漏洞。 
       
- 危害
  - 利用虚假的 ( 输入表单 )，骗取用户个人信息
  - 利用 ( 脚本 )，获取用户的 cookie
  - 显示伪造的图片，文章等

- 如何预防XSS攻击呢？
   - 1. 设置 cookie 的 httpOnly 属性，来阻止通过js脚本或其他脚本，来获取cookie
        - XMLHttpRequest: response.setHeader("Set-Cookie", "key=value;Max-Age=seconds;HTTPOnly");
        - 哪些脚本可以获取cookie: Document.cookie属性，XMLHttpRequest对象， Request API
   - 2. 标签转义
    - 对表单的input textArea form 等做 ( 特殊符号 ) 的过滤检查
    - htmlEncode: 某些情况下，不能对用户数据进行严格过滤，需要对标签进行转换
    - javascriptEncode // - Javascript编码   
```

## （三）浏览器 - 缓存
  - 强缓存
  - 协商缓存
  - service worker 缓存

        资源缓存的位置
        ```js
            按优先级从高到低分别是：
            - Service worker
            - Memory Cache
            - Disk Cache

            service worker 是运行在主线程之外的，无法访问dom，离线存储，消息推送，网络代理

            memory cache
                内存缓存，它的效率最快
            disk cache
                磁盘缓存，能存储的数据覆盖面大
        ```
    
        ```js
            协商缓存和强缓存的区别
            1. 是否与服务器通信
            2. 请求头、响应头字段不一样
            3. 状态码不一致
            
            cache-control
            expires
            
            // 请求头
            Etag
            if-modify-since

            // 对应的响应头
            if-none-match
            Last-Modified
        ```

        
        ```js
            Service Work
            可以进行缓存功能
            Service Worker的话，传输协议必须为 HTTPS，本地开发可以localhost，
                - 因为涉及到请求拦截，运行在主线程之外，通过注册进行实现，
            有现成的库
        ```

## (四) 浏览器的渲染过程
    html 解析生成 DOM树
    CSS解析器 解析生成 CSS树
    结合生成 render 树
    构建render树
    绘制render
    浏览器将各层信息发给GPU，GPU将各个层合层，显示到屏幕上

    注意： 这个过程是逐步完成的，并不会等到全部显示出来才去构建和布局render树，它是解析完一部分内容就显示一部分内容，同时，可能还在通过网络下载其余内容。

    扩展：加载 CSS 会阻塞文档解析?

    ```js
        浏览器会创建
        然而，存在一个问题，JavaScript 脚本执行时可能在文档的解析过程中请求样式信息，如果样式还没有加载和解析，脚本将得到错误的值，显然这将会导致很多问题。
    
    ```
    扩展：什么情况会阻塞渲染?
    
    ```js
        - CSS阻塞渲染
            - 在构建渲染树时，需要完备的DOM树，CSSOM树，而CSSOM的解析可能会阻塞DOM解析，或者CSSOM树的未完成会阻塞渲染树的构建，这就是CSS阻塞渲染。

        -JS阻塞渲染
            - JS 可以查询和修改 DOM 与 CSSOM，所以当 HTML 解析器遇到一个 script 标记时，它会暂停构建 DOM，将控制权移交给 JS 引擎， HTML 解析器会等待 JS 引擎运行完毕，这就是所谓的JS阻塞渲染。
    ```


###  15. Cookie、LocalStorage、SessionStorage区别?
大小

SessionStorage 每个窗口独立



### 16. Cookie有哪些字段，作用分别是什么?
expires
domain ： 可以访问该cookie的域名
path： 可以访问此cookie的页面路径。 
http: httpOnly
Expires max-size


## (四)浏览器 - 跨域
 ### 什么是同源策略
 协议 域名 端口

 ### 18. 如何解决跨越问题 （重点关注）

### 19. 如何阻止事件冒泡
### 20. 对事件委托的理解

## (五) 浏览器 - 事件循环 
    ### 对事件循环的理解（重点关键）
    
    ### 宏任务和微任务分别有哪些
    
    ### 事件触发的过程是怎样的 
## (六) 浏览器 - 垃圾回收机制
    ### 24. 浏览器的垃圾回收机制
